{{ define "title" }}{{ .Title }} â€” {{ .Site.Title }}{{ end }}

{{ define "main" }}
<article class="hentry post">
  <header>
    <h1 class="entry-title">{{ .Title }}</h1>

    <p class="meta">
      By
      <span class="author vcard">
        <a class="url fn n" href="/">
          <span class="given-name">{{ .Site.Params.author_first }}</span>
          <span class="family-name">{{ .Site.Params.author_last }}</span>
        </a>
      </span>
      |
      <time class="published" datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
        <a href="{{ .Permalink }}" rel="bookmark">
          <span class='month'>{{ .Date.Format "January" }}</span>
          <span class='day'>{{ .Date.Format "2nd" }}</span>
          <span class='year'>{{ .Date.Format "2006" }}</span>
        </a>
      </time>
    </p>

    {{ with .Params.tags }}
      <p class="tags">
        {{ range $index, $tag := . }}
          {{ $tagIndex := add (mod $index 8) 1 }}
          <a class="tag-color tag-color-{{ $tagIndex }}" href="/tags/{{ $tag | urlize }}" rel="tag">{{ $tag }}</a>
        {{ end }}
      </p>
    {{ end }}
  </header>

  <div class="entry-content content">
    {{ .Content }}
  </div>

  {{ if or .PrevInSection .NextInSection }}
    <nav class="article">
      <div class="previous-next">
        {{ with .NextInSection }}
          <div class="next">
            <a href="{{ .Permalink }}" title="{{ .Title }}">
              <span class="title">{{ .Title }}</span>
              <span class="arrow arrow-east"></span>
            </a>
          </div>
        {{ end }}
        {{ with .PrevInSection }}
          <div class="previous">
            <a href="{{ .Permalink }}" title="{{ .Title }}">
              <span class="arrow arrow-west"></span>
              <span class="title">{{ .Title }}</span>
            </a>
          </div>
        {{ end }}
      </div>
    </nav>
  {{ end }}

  {{ if not (eq .Params.comments false) }}
    <div id="disqus_thread"></div>
    <script>
      // Convert new Hugo URL format to old Sculpin format for Disqus
      // New: /YYYY-MM-DD-slug/  ->  Old: /YYYY/MM/DD/slug/
      var disqus_config = function () {
        {{ $datePath := .Date.Format "2006/01/02" }}
        {{ $slug := replaceRE "^[0-9]{4}-[0-9]{2}-[0-9]{2}-" "" .File.BaseFileName }}
        // Use http:// to match old Sculpin threads (with double trailing slash!)
        this.page.url = "http://naxoc.net/{{ $datePath }}/{{ $slug }}//";
        this.page.identifier = "http://naxoc.net/{{ $datePath }}/{{ $slug }}//";
      };
      (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://{{ site.Config.Services.Disqus.Shortname }}.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
  {{ end }}
</article>
{{ end }}
